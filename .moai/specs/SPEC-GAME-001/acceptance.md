# SPEC-GAME-001 인수 기준

## 개요

라이어 게임 핵심 로직의 인수 테스트 시나리오 (Given-When-Then 형식)

## 1. 게임 상태 전환

### 1.1 WAITING → PLAYING
**Given** 방장이 방을 생성하고 5명의 플레이어가 대기 중일 때
**When** 방장이 게임 시작 버튼을 클릭하면
**Then** 게임 상태가 PLAYING으로 변경되고 역할이 배정된다

### 1.2 PLAYING → DISCUSSION
**Given** 모든 플레이어가 첫 번째 발언을 완료했을 때
**When** 마지막 플레이어의 발언이 끝나면
**Then** 게임 상태가 DISCUSSION으로 전환되고 토론 시간이 시작된다

### 1.3 DISCUSSION → VOTING
**Given** 토론 시간이 60초로 설정되고 토론이 진행 중일 때
**When** 60초가 경과하면
**Then** 게임 상태가 VOTING으로 전환되고 투표가 시작된다

### 1.4 VOTING → FINISHED
**Given** 모든 플레이어가 투표를 완료했을 때
**When** 투표 집계가 완료되면
**Then** 게임 상태가 FINISHED로 전환되고 결과가 표시된다

## 2. 역할 배정 시스템

### 2.1 라이어 배정
**Given** 6명의 플레이어가 게임에 참여할 때
**When** 게임이 시작되면
**Then** 정확히 1명의 플레이어가 라이어로 지정되고 5명은 시민이 된다

### 2.2 역할 정보 보호
**Given** 라이어로 지정된 플레이어가 있을 때
**When** 다른 플레이어들이 역할 정보를 조회하면
**Then** 자신의 역할만 확인할 수 있고 다른 플레이어의 역할은 비공개로 유지된다

### 2.3 키워드 접근
**Given** 시민 플레이어와 라이어 플레이어가 있을 때
**When** 게임이 시작되면
**Then** 시민은 실제 키워드를 보고 라이어는 힌트만 볼 수 있다

## 3. 턴 관리 시스템

### 3.1 정상 턴 전환
**Given** 현재 플레이어 A의 턴이고 30초 발언 시간이 주어졌을 때
**When** 플레이어 A가 발언을 마치면
**Then** 다음 플레이어 B에게 턴이 넘어가고 시간이 초기화된다

### 3.2 시간 초과 자동 전환
**Given** 플레이어의 턴이고 30초 시간제한이 있을 때
**When** 30초 동안 발언이 없으면
**Then** 자동으로 다음 플레이어에게 턴이 넘어간다

### 3.3 턴 순서 확인
**Given** 4명의 플레이어가 시계 방향으로 A, B, C, D 순서일 때
**When** A의 턴이 끝나면
**Then** B가 다음 턴을 받고 C, D 순서로 진행된다

## 4. 키워드 선택 시스템

### 4.1 쉬움 난이도 키워드
**Given** 난이도가 '쉬움'으로 설정되었을 때
**When** 게임이 시작되면
**Then** 사과, 의자, 학교 등 일상적인 단어 중 하나가 선택된다

### 4.2 어려움 난이도 키워드
**Given** 난이도가 '어려움'으로 설정되었을 때
**When** 게임이 시작되면
**Then** 추상적이거나 전문적인 단어가 선택되고 라이어는 관련 힌트를 받는다

### 4.3 키워드 중복 방지
**Given** 이전 게임에서 '사과'가 선택되었을 때
**When** 새 게임이 시작되면
**Then** '사과'를 제외한 다른 키워드가 선택된다

## 5. 발언 시스템

### 5.1 자신의 턴에만 발언
**Given** 플레이어 A의 턴이 아닐 때
**When** 플레이어 A가 발언 버튼을 클릭하면
**Then** 발언 버튼이 비활성화되고 메시지를 전송할 수 없다

### 5.2 실시간 메시지 전송
**Given** 플레이어가 자신의 턴에 발언을 작성하고 전송할 때
**When** 전송 버튼을 클릭하면
**Then** 모든 플레이어의 화면에 실시간으로 메시지가 표시된다

### 5.3 부적절한 내용 필터링
**Given** 플레이어가 비속어가 포함된 발언을 작성할 때
**When** 전송을 시도하면
**Then** 비속어가 **로 대체되거나 전송이 차단된다

## 6. 투표 시스템

### 6.1 익명 투표
**Given** 투표 단계가 시작되고 플레이어가 투표할 때
**When** 특정 플레이어를 선택하고 투표하면
**Then** 다른 플레이어들은 누가 누구에게 투표했는지 볼 수 없다

### 6.2 중복 투표 방지
**Given** 플레이어가 이미 투표를 완료했을 때
**When** 다시 투표를 시도하면
**Then** "이미 투표했습니다" 메시지가 표시되고 투표가 불가능하다

### 6.3 투표 결과 공개
**Given** 모든 플레이어가 투표를 완료했을 때
**When** 투표 집계가 완료되면
**Then** 각 플레이어별 득표수가 모두에게 공개된다

## 7. 승패 계산

### 7.1 라이어 승리
**Given** 실제 라이어가 A이고 투표에서 B가 가장 많은 득표를 했을 때
**When** 투표가 종료되면
**Then** 라이어가 승리하고 "라이어가 살아남았습니다!" 메시지가 표시된다

### 7.2 시민 승리
**Given** 실제 라이어가 A이고 투표에서 A가 가장 많은 득표를 했을 때
**When** 투표가 종료되면
**Then** 시민이 승리하고 "라이어를 찾아냈습니다!" 메시지가 표시된다

### 7.3 동수 득표 시
**Given** 두 명의 플레이어가 동일한 최다 득표를 했을 때
**When** 투표가 종료되면
**Then** 동수 득표자 중에서 재투표가 진행된다

## 8. AI 플레이어

### 8.1 자동 발언
**Given** AI 플레이어의 턴일 때
**When** 발언 시간이 시작되면
**Then** AI는 3~5초 후 자동으로 관련 내용을 발언한다

### 8.2 AI 투표
**Given** 투표 단계이고 AI 플레이어가 있을 때
**When** 투표가 시작되면
**Then** AI는 다른 플레이어들의 발언 패턴을 기반으로 자동 투표한다

## 9. 예외 상황 처리

### 9.1 플레이어 연결 끊김
**Given** 게임 진행 중 플레이어의 연결이 끊어졌을 때
**When** 10초 동안 재접속이 없으면
**Then** AI 플레이어로 대체되거나 게임이 일시중지된다

### 9.2 최소 인원 미만
**Given** 게임 진행 중 인원이 2명 이하로 줄었을 때
**When** 상태 확인 주기가 도래하면
**Then** 게임이 강제 종료되고 "인원 부족으로 게임이 종료되었습니다" 메시지가 표시된다

## 품질 게이트 기준

- 모든 기능 테스트 통과율: 100%
- 상태 전환 정확도: 100%
- 실시간 응답 시간: 200ms 이하
- 동시 사용자 지원: 최대 100개 방
- 데이터 정합성: 모든 상태 변경 기록
- 보안: 역할 정보 유출 없음